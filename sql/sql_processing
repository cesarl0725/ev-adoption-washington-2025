/*
Query 1
- Purpose: The purpose of this query is to streamline the clean_alternative_fuel_vehicle_(cafv)_eligibility column.
This allows the audience to be able to clearly understand what they are seeing when interacting with 
visuals related to this column.

- Code detail: To make sure I accounted for all the possibilities in my case statement, I included ELSE 'DOUBLE CHECK' so in the 
case that I missed a possibility, I would be able to tell immediately and fix my mistake.
*/
SELECT
vin,
county,
city,
state,
postal_code,
model_year,
make,
model,
electric_vehicle_type_v1,
CASE
	WHEN "clean_alternative_fuel_vehicle_(cafv)_eligibility" LIKE '%unknown%' THEN 'unknown'
	WHEN "clean_alternative_fuel_vehicle_(cafv)_eligibility" LIKE '%Not eligible%' THEN 'not eligible'
	WHEN "clean_alternative_fuel_vehicle_(cafv)_eligibility" LIKE '%Vehicle Eligible%' THEN 'eligible'
	ELSE 'DOUBLE CHECK'
END AS clean_alternative_fuel_vehicle_eligibility
FROM
ev_adoption_port_project

---------------------------------------------------------------------------------------------------------------------------------

/*
Query 2/ New  table creation
- Purpose: The purpose of this query is twofold: first, transform the electric_vehicle_type_v1 to include a more streamlined 
version of its original content, making visualizations more digestible. Second, create a new table where all the data 
transformations are in one place, making analysis more straightforward.

- Code detail: Instead of creating two separate tables, one for the original transformation and another for this transformation
I chose to reference the original query as a subquery within this statement. This eliminates the need to create an 
additional intermediate table, making the process more efficient.
*/
CREATE TABLE ev_adoption_port_project_processed AS
SELECT
vin,
county,
city,
state,
postal_code,
model_year,
make,
model,
CASE
	WHEN electric_vehicle_type_v1 LIKE 'Battery Electric Vehicle (BEV)' THEN 'BEV'
	WHEN electric_vehicle_type_v1 LIKE 'Plug-in Hybrid Electric Vehicle (PHEV)' THEN 'PHEV'
	ELSE 'DOUBLE CHECK'
END AS electric_vehicle_type,
clean_alternative_fuel_vehicle_eligibility
FROM
(SELECT
vin,
county,
city,
state,
postal_code,
model_year,
make,
model,
electric_vehicle_type_v1,
CASE
	WHEN "clean_alternative_fuel_vehicle_(cafv)_eligibility" LIKE '%unknown%' THEN 'unknown'
	WHEN "clean_alternative_fuel_vehicle_(cafv)_eligibility" LIKE '%Not eligible%' THEN 'not eligible'
	WHEN "clean_alternative_fuel_vehicle_(cafv)_eligibility" LIKE '%Vehicle Eligible%' THEN 'eligible'
	ELSE 'DOUBLE CHECK'
END AS clean_alternative_fuel_vehicle_eligibility
FROM
ev_adoption_port_project) AS ev_adoption_port_project_edit
